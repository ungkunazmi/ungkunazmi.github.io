<!DOCTYPE html>



  


<html class="theme-next mist use-motion" lang="en">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2"/>
<meta name="theme-color" content="#222">












<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />






















<link href="../../../../lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="../../../../css/main.css?v=6.0.6" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="../../../../images/apple-touch-icon-next.png?v=6.0.6">


  <link rel="icon" type="image/png" sizes="32x32" href="../../../../images/favicon-32x32-next.png?v=6.0.6">


  <link rel="icon" type="image/png" sizes="16x16" href="../../../../images/favicon-16x16-next.png?v=6.0.6">


  <link rel="mask-icon" href="../../../../images/logo.svg?v=6.0.6" color="#222">









<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    version: '6.0.6',
    sidebar: {"position":"left","display":"always","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: false,
    fastclick: false,
    lazyload: false,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  
<meta name="description" content="Be yourself">
<meta name="keywords" content="WebSecurity">
<meta property="og:type" content="article">
<meta property="og:title" content="How I found Bug in 83 Malaysia Gov CWE285 CWE-434">
<meta property="og:url" content="ungkunazmi.github.io/2022/11/17/83-GOV-MY-BUG/">
<meta property="og:site_name" content="UngkuNazmi">
<meta property="og:description" content="Be yourself">
<meta property="og:locale" content="en">
<meta property="og:image" content="../../../../images/83-GOV-MY-BUG/OnclickBypass.png">
<meta property="og:image" content="../../../../images/83-GOV-MY-BUG/scan.png">
<meta property="og:updated_time" content="2022-11-17T00:00:00.00">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="How I found Bug in 83 Malaysia Gov CWE285 CWE-434">
<meta name="twitter:description" content="Be yourself">
<meta name="twitter:image" content="../../../../images/83-GOV-MY-BUG/OnclickBypass.png">
<div id="fb-root"></div>
<script async defer crossorigin="anonymous" src="https://connect.facebook.net/en_GB/sdk.js#xfbml=1&version=v15.0" nonce="SL8NNTih"></script>


  <link rel="alternate" href="../../../../atom.xml" title="Donnazmi" type="application/atom+xml" />



  <link rel="canonical" href="../../../../2022/11/17/83-GOV-MY-BUG/"/>



<script type="text/javascript" id="page.configurations">
  CONFIG.page = {
    sidebar: "",
  };
</script>

  <title>How I found Bug in 83 Malaysia Gov CWE285 CWE-434 | Ungku Nazmi</title>
  









  <noscript>
  <style type="text/css">
    .use-motion .motion-element,
    .use-motion .brand,
    .use-motion .menu-item,
    .sidebar-inner,
    .use-motion .post-block,
    .use-motion .pagination,
    .use-motion .comments,
    .use-motion .post-header,
    .use-motion .post-body,
    .use-motion .collection-title { opacity: initial; }

    .use-motion .logo,
    .use-motion .site-title,
    .use-motion .site-subtitle {
      opacity: initial;
      top: initial;
    }

    .use-motion {
      .logo-line-before i { left: initial; }
      .logo-line-after i { right: initial; }
    }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="en">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"> 

<div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="../../../../" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Ungku Nazmi</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button aria-label="Toggle navigation bar">
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        
          
  <li class="menu-item menu-item-home">
    <a href="../../../../" rel="section">
      <i class="menu-item-icon fa fa-fw fa-home"></i> <br />Home</a>
</li>

      
        
        
          
  <li class="menu-item menu-item-about">
    <a href="../../../../about/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-user"></i> <br />About</a>
</li>

      
        
        
          
  <li class="menu-item menu-item-tags">
    <a href="../../../../tags/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />Tags</a>
</li>

      
        
        
          
  <li class="menu-item menu-item-categories">
    <a href="../../../../categories/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-th"></i> <br />Categories</a>
</li>

      
        
        
          
  <li class="menu-item menu-item-archives">
    <a href="../../../../archives/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />Archives</a>
</li>

      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br />Search</a>
        </li>
      
    </ul>
  

  
    

    
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
    

  


  

  
<div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off"
             placeholder="Searching..." spellcheck="false"
             type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>


  



 </div>
    </header>

    


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="ungkunazmi.github.io/2022/11/17/83-GOV-MY-BUG/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Ungku Nazmi">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="../../../../uploads/1.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Ungku Nazmi">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">How I found Bug in 83 Malaysia Gov CWE285 CWE-434</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Published on</span>
              
              <time title="Built in" itemprop="dateCreated datePublished" datetime="2022-11-17T00:00:00+00:00">2022-11-17</time>
            

            
            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">Classified in</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/WebSecurity/" itemprop="url" rel="index"><span itemprop="name">WebSecurity</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          
             <span id="../../../../2022/11/17/83-GOV-MY-BUG/" class="leancloud_visitors" data-flag-title="How I found Bug in 83 Malaysia Gov CWE285 CWE-434">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-thermometer-three-quarters"></i>
               </span>
               
                 <span class="post-meta-item-text">heat</span>
               
                 <span class="leancloud-visitors-count"></span>
				         <span>â„ƒ</span>
             </span>
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      

<p>Be yourself use your brain<br><a id="more"></a></p>

<h2 id="CWE285">
<a href="#CWE285" class="headerlink" title="CWE285">
</a>[CWE285 Preface]</h2>
83 Malaysia Gov Website Improper Authorization (CWE-285)
<p>A couple of days ago,
I was looking for a certain new exploit 0-day in google search for researching,due so many news article gov data leaked and Hacked, where suddenly I stumbled upon a Login and Register form that was laying around.Some of the website can register as normal user And some of the website has no Register button or Register link at thier home page.
Immediately I wonderedâ€¦<em>Could I hack it?</em></p>

<center><p><img src="../../../../images/83-GOV-MY-BUG/intrologo.png" alt="intrologo" /></p></center>
<p style="text-align: center; font-style: italic"><small>Perhaps. "Secure"? Not so much.</small></p>

<h3 id="CWE2852">
<a href="#CWE2852" class="headerlink" title="CWE2852">
</a>[Risk Factors]</h3>
<p>The impact of this vulnerability is high, supposed code can be executed in the server context or on the client side. 
The likelihood of detection for the attacker is high. The prevalence is common. As a result the severity of this type of vulnerability is high.</p>
<p><strong>Vulnerable Apps Version 2.*.*</strong></p>


<p>It worked well for me because I was just looking for a Bug , I thought it could be an interesting challenge..</p>
<p>I was lucky today because apparently I have found a Vendor that provides System Asset that is used on almost 100 government websites.</p>
<p>*Helpdesk Ticketing Solution *Asset Management System *Store Management System</p>

<h3 id="CWE2853">
<a href="#CWE2853" class="headerlink" title="CWE2853">
</a>[Getting Started]</h3>
<p>I connected the website to my computer and right away jumped onto the research.
I started off with a good olâ€™ opened all website interfaces and my potential attack vectors.</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
Login to the website
âžœ  ~ .gov.my/**serv/
POST /**serv/module/login/act_login.c**?action_target=undefined
Register to the website
âžœ  ~ .gov.my/**serv/
GET /**serv/module/login/bypass/register.c**
</code></pre></div></div>

<p>Unsurprisingly, looks like all we got to work with is the web server. Off we go then.</p>

<p>Browsing to the website presents a login prompt and Register Link, to which I authenticate with the Fake Registration adding username and password as a normal user/staff due to improper authorization in account creation functionality allow any user create account without authentication and shortly afterwards Iâ€™m introduced to the following control and management page.</p>

<center><p><img src="../../../../images/83-GOV-MY-BUG/Login.png" alt="Web Interface" /></p></center>

<p style="text-align: center; font-style: italic"><small>The Login's web interface.</small></p>

<p><img src="../../../../images/83-GOV-MY-BUG/daftar.png" alt="Web Interface" /></p>

<p style="text-align: center; font-style: italic"><small>The Register web interface.</small></p>

<p><img src="../../../../images/83-GOV-MY-BUG/loginloadingsuccess.png" alt="Web Interface" /></p>

<p style="text-align: center; font-style: italic"><small>The Loading web interface.</small></p>

<p><img src="../../../../images/83-GOV-MY-BUG/HelpDesk.png" alt="Web Interface" /></p>

<p style="text-align: center; font-style: italic"><small>The Helpdesk web interface.</small></p>

<p><img src="../../../../images/83-GOV-MY-BUG/Gasset.png" alt="Web Interface" /></p>

<p style="text-align: center; font-style: italic"><small>The Asset web interface.</small></p>

<p><img src="../../../../images/83-GOV-MY-BUG/ResponseLogin.png" alt="Web Interface" /></p>

<h3 id="CWE2854">
<a href="#CWE2854" class="headerlink" title="CWE2854">
</a>[Hacking Time]</h3>
<p>Initially, I was looking for potential input from clients when I came across a page with no user registration link that using same code's / plugin.
<img src="../../../../images/83-GOV-MY-BUG/LoginNoReg.png" alt="Diagnostics Page" /></p>
<p style="text-align: center; font-style: italic"><small>The web interface with no register link.</small></p>
<p>I thought it could be a good place to apply the oldest blackbox technique in the book - <em>Onclick Injection</em>.
<p>I get the code on the page that have the registration link to create newAccount</em>.
<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
Register to the website
âžœ  ~ .gov.my/**serv/
GET /**serv/module/login/bypass/register.c**
âžœ  Bypass Code : href="#" onclick="newAccount();">Daftar Baru<
</code></pre></div></div>
<p><img src="../../../../images/83-GOV-MY-BUG/OnclickBypass.png" alt="Web Interface" /></p>

<p style="text-align: center; font-style: italic"><small>The Register Bypass</small></p>


Unfortunately, client-side validation was applied due Improper authorization in account creation functionality allow any user create account without authentication.</p>

<p><img src="../../../../images/83-GOV-MY-BUG/SuccessBypass.png" alt="Web Interface" /></p>

<p style="text-align: center; font-style: italic"><small>Successfully Register Bypassed</small><p>

<h3 id="CWE2855">
<a href="#CWE2855" class="headerlink" title="CWE2855">
</a>[POC VIDEO :]</h3>
<center><iframe style="width: 720px; height: 400px; margin: 0.5rem" src="https://www.youtube.com/embed/sTSA_sWGM44" frameborder="0" allowfullscreen=""></iframe></center>

<h3 id="CWE2856">
<a href="#CWE2856" class="headerlink" title="CWE2856">
</a>[Concluding]</h3>
<p>Mission accomplished! Full Bypass Login to get Access into thier system.<br /><p>
<p>Since people have been asking, <strong>the bug had already been fixed.</strong><br /><p>


<h2 id="CWE434">
<a href="#CWE434" class="headerlink" title="CWE434">
</a>[CWE-434 Preface]</h2>
<p>83 Malaysia Gov Website Arbitrary File Upload (CWE-434)
Combined exploit for Improper Authorization (CWE-285)
File upload for Arbitrary File Upload (CWE-434)- will automatically upload the file An arbitrary file 
upload vulnerability in the picture upload function of Asset_Module (*-asset)(*-Serv) allows attackers to execute arbitrary code via .c** file extension.<p>
The application failed to validate file uploaded by any authenticated user, leading to code execution

<h3 id="CWE4341">
<a href="#CWE4341" class="headerlink" title="CWE4341">
</a>[Risk Factors]</h3>
The impact of this vulnerability is high, supposed code can be executed in the server context or on the client side. The likelihood of detection for the attacker is high. 
The prevalence is common. 
As a result the severity of this type of vulnerability is high.

<h3 id="CWE4342">
<a href="#CWE4342" class="headerlink" title="CWE4342">
</a>[Vulnerability to reproduce]</h3>
<p>Log in to the Dashboard Asset_Module by using normal user of the website.</p>
<p>Click On "Carian Pantas" or "Borang Aduan" find Upload button.</p>

<p><img src="../../../../images/83-GOV-MY-BUG/Gasset.png" alt="Web Interface" /></p>
<p style="text-align: center; font-style: italic"><small>Carian Pantas web interface.</small></p>

<p><img src="../../../../images/83-GOV-MY-BUG/GassetVuln.png" alt="Web Interface" /></p>
<p style="text-align: center; font-style: italic"><small>Carian Pantas Page Vulnerable.</small></p>

<p><img src="../../../../images/83-GOV-MY-BUG/HelpDesk.png" alt="Web Interface" /></p>
<p style="text-align: center; font-style: italic"><small>Borang Aduan web interface.</small></p>

<p><img src="../../../../images/83-GOV-MY-BUG/dsp_borang_isi.png" alt="Web Interface" /></p>
<p style="text-align: center; font-style: italic"><small>Borang Aduan Page Vulnerable.</small></p>
<p>Open BurpSuite Capture thier Data Click "Intercept is On" before Uploading...</p>
<p>Open back your browser Upload the file nouser.jpg (Make sure turn on your Intercept burp suite)</p>
<p>Check Burp Suite will show the data upload, and change filename to nouser.jpg to nouser.c** </p>
<p>the content of the file is as follows video:</p>

<h3 id="CWE4343">
<a href="#CWE4343" class="headerlink" title="CWE4343">
</a>[POC VIDEO :]</h3>
<center><iframe style="width: 720px; height: 400px; margin: 0.5rem" src="https://www.youtube.com/embed/sTSA_sWGM44" frameborder="0" allowfullscreen=""></iframe></center>
<p>Click Forward to send the file into the server</p>
<p>Visit your Shell</p> 
<p>Shell Path :</p>
<p>localhost/**serv_document_***/lampiran_aduan/nouser.c**</p>
<p>localhost/**serv_picture_***/asset/nouser.c**</p>
<p>After I'm able to find this vulnerability on this Vendor code/plugin, I create a simple python scan, to check the vuln.<p/>
<center><p><img src="../../../../images/83-GOV-MY-BUG/scan.png" alt="Scan" /></p></center>
<p style="text-align: center; font-style: italic"><small>Scanning All Web Vulnerable.</small></p>
<p>The path of vuln for scan /**serv (requests.get) , the result shown VULNERABLE due all this server using same code.</p>
<p>And finally I report this vulnerability to MyCert Team to contact the Vendor and Fix the problem.</p>

<h3 id="CWE4344">
<a href="#CWE4344" class="headerlink" title="CWE4344">
</a>[Updating Reported]</h3>
<p>I think I want to try to see if they really fix the existing weaknesses.<em>Could I bypass it again?</em></p>
<p>Date : 7 January 2023<p>
<p>After report this issue bug vulnerability of this application , I was unable to upload shell bypass .c** file and I'm assuming they've fixed bypass shell upload.</p>
<p>*I was able to login into the web server as normal user after this hack/report</p>
<p>Some of the website has been Fix due my reported Onclick Create Account Bypass
<p>So, I try to login into the dashboard , and bypass another file extention and unexpected because I can still bypass other files other than the .c** file this file called .config </p>
<p></p>
<center><p><img src="../../../../images/83-GOV-MY-BUG/shell.png" alt="Scan" /></p></center>
<p style="text-align: center; font-style: italic"><small>Successfull bypass .config files</small></p>

<h3 id="CWE4345">
<a href="#CWE4345" class="headerlink" title="CWE4345">
</a>[Concluding]</h3>
<p>Mission accomplished! Full Bypass Login to get Access into thier system.<br /><p>
<p>Since people have been asking, <strong>the bug had already been fixed.</strong><br /><p>
<br>Sorry about my english, is so badðŸ˜…</a>
<br>Thanks for reading.</a>
<h3 id="DISCLAIMER">
<a href="#DISCLAIMER" class="headerlink" title="DISCLAIMER">
</a>DISCLAIMER :</h3>
<strong><p style="text-align: center; font-style: italic">This Exploit I've report to MyCert Team November 2022 9:50 PM</p></strong></center>
<p><em>Anything u learned from the Blog just for research and educational purposes only
Do not use the knowledge for illegal things.</em></p>

<h1 id="preface">[Affected Product Code Base]</h1>
<p>Vulnerable Apps Version 2.*.*</p>
<h1 id="preface">[Vulnerable path]</h1>
<p>localhost/**serv/module/*-asset</p>
<p>localhost/**serv/module/aduan</p>
<h1 id="preface">[Vendor of Product]</h1>
<p>Go**** Technology Sdn Bhd</p>

<h1 id="preface">[Affected Component]</h1>
<p>Login functionality,File upload functionality, Picture functionality</p>

<h2 id="preface">[Has vendor confirmed or acknowledged the vulnerability?]</h2> <p>true</p>

<h1 id="preface">[Additional Information]</h1>
<p>This registration and file uploaded would be accepted by the application and stored on the server of the application database. </p>

    </div>

    
    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="../../../../tags/WebSecurity/" rel="tag">#WebSecurity</a> <a href="../../../../tags/BugReport/" rel="tag">#BugReport</a><a href="../../../../tags/Bug/" rel="tag">#Bug</a><a href="../../../../tags/Bypass/" rel="tag">#Bypass</a><a href="../../../../tags/Vulnerabilities/" rel="tag">#Vulnerabilities</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="../../../../2022/10/24/SABAH-GOV-MY-BUG/" rel="next" title="CYBERSECURITY">
                <i class="fa fa-chevron-left"></i>SABAH GOV MY BUG
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="../../../../2022/11/18/JHEV-GOV-MY-BUG/" rel="prev" title="105-IP-MALAYSIA-BUG">
                JHEV GOV MY BUG<i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      
                <center>
                  <div class="fb-like" data-href="https://ungkunazmi.github.io/2022/11/17/83-GOV-MY-BUG/" data-width="" data-layout="standard" data-action="like" data-size="small" data-share="true"></div>
                </center>
      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          

  
    <div class="comments" id="comments">
      <div id="lv-container" data-id="city" data-uid="MTAyMC8zNDg3OS8xMTQxNg=="></div>
    </div>

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            Article directory
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            Site overview
          </li>
        </ul>
      
      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image"
                src="../../../../uploads/1.png"
                alt="Donnazmi" />
            
              <p class="site-author-name" itemprop="name">Ungku Nazmi</p>
              <p class="site-description motion-element" itemprop="description">wait... what??????</p>
          </div>

          
            <nav class="site-state motion-element">
              
                <div class="site-state-item site-state-posts">
                
                  <a href="../../../../archives/">
                
                    <span class="site-state-item-count">24</span>
                    <span class="site-state-item-name">Log</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-categories">
                  <a href="../../../../categories/">
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">10</span>
                    <span class="site-state-item-name">Categories</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-tags">
                  <a href="../../../../tags/">
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">23</span>
                    <span class="site-state-item-name">Label</span>
                  </a>
                </div>
              
            </nav>
          

          
            <div class="feed-link motion-element">
              <a href="../../../../atom.xml" rel="alternate">
                <i class="fa fa-rss"></i>
                RSS
              </a>
            </div>
          

          
            <div class="links-of-author motion-element">
              
                <span class="links-of-author-item">
                  <a href="https://github.com/ungkunazmi" target="_blank" title="GitHub"><i class="fa fa-fw fa-github"></i>GitHub</a>
                  
                </span>
              
                <span class="links-of-author-item">
                  <a href="/" target="_blank" title="E-Mail"><i class="fa fa-fw fa-envelope"></i>E-Mail</a>
                  
                </span>
              
                <span class="links-of-author-item">
                  <a href="https://t.me/donnazmi" target="_blank" title="CSDN"><i class="fa fa-fw fa-telegram"></i>Telegram</a>
                  
                </span>
                <span class="links-of-author-item">
                  <a href="https://www.youtube.com/@donnazmichannel" target="_blank" title="CSDN"><i class="fa fa-fw fa-youtube"></i>Youtube</a>
                  
                </span>
                <span class="links-of-author-item">
                  <a href="https://www.instagram.com/_unazmi" target="_blank" title="CSDN"><i class="fa fa-fw fa-instagram"></i>Instagram</a>
                  
                </span>
                <span class="links-of-author-item">
                  <a href="https://codepen.io/ungkunazmi" target="_blank" title="CSDN"><i class="fa fa-fw fa-codepen"></i>Codepen</a>
                  
                </span>
                <span class="links-of-author-item">
                  <a href="/" target="_blank" title="CSDN"><i class="fa fa-fw fa-medium"></i>Medium</a>
                  
                </span>
            </div>
          

          
          

          
          
            <div class="links-of-blogroll motion-element links-of-blogroll-inline">
              <div class="links-of-blogroll-title">
                <i class="fa  fa-fw fa-bullhorn"></i>
                Links
              </div>
              <ul class="links-of-blogroll-list">
                
                  <li class="links-of-blogroll-item">
                    <a href="/" title="R06U3" target="_blank">R06U3</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="/" title="7RU57" target="_blank">7RU57</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="/" title="FL45H" target="_blank">FL45H</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="/" title="W3B" target="_blank">W3B</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="/" title="V1510N" target="_blank">V1510N</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="/" title="BL4NK" target="_blank">BL4NK</a>
                  </li>
                  <li class="links-of-blogroll-item">
                    <a href="https://cwe.mitre.org/" title="CWE" target="_blank">CWE</a>
                  </li>
                
              </ul>
            </div>
          

          
            
          
          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">
       
             
              <div class="post-toc-content">
			  <ol class="nav">	  
			  <li class="nav-item nav-level-2">
			  <a class="nav-link" href="#CWE285">
			  <span class="nav-number">1.</span> 
			  <span class="nav-text">CWE285 Preface</span></a>
			  <ol class="nav-child">
			  <li class="nav-item nav-level-3">
			  <a class="nav-link" href="#CWE2852">
			  <span class="nav-number">1.1.</span> 
			  <span class="nav-text">Risk Factors</span></a></li>
			  <li class="nav-item nav-level-3">
			  <a class="nav-link" href="#CWE2853">
			  <span class="nav-number">1.2.</span> 
			  <span class="nav-text">Getting Started</span></a></li>
			  <li class="nav-item nav-level-3">
			  <a class="nav-link" href="#CWE2854">
			  <span class="nav-number">1.3.</span>
			  <span class="nav-text">Hacking Time</span></a></li>
			  <li class="nav-item nav-level-3">
			  <a class="nav-link" href="#CWE2855">
			  <span class="nav-number">1.4.</span>
			  <span class="nav-text">P0c Video</span></a></li>
			  <li class="nav-item nav-level-3">
			  <a class="nav-link" href="#CWE2856">
			  <span class="nav-number">1.5.</span> 				  
			  <span class="nav-text">Concluding</span></a></ol></li>

			  <li class="nav-item nav-level-2">
			  <a class="nav-link" href="#CWE434">
			  <span class="nav-number">2.</span> 
			  <span class="nav-text">CWE434 Preface</span></a>
			  <ol class="nav-child">
			  <li class="nav-item nav-level-3">
			  <a class="nav-link" href="#CWE4341">
			  <span class="nav-number">2.1.</span> 
			  <span class="nav-text">Risk Factors</span></a></li>
			  <li class="nav-item nav-level-3">
			  <a class="nav-link" href="#CWE4342">
			  <span class="nav-number">2.2.</span> 
			  <span class="nav-text">Vulnerability Reproduce</span></a></li>
			  <li class="nav-item nav-level-3">
			  <a class="nav-link" href="#CWE4343">
			  <span class="nav-number">2.3.</span>
			  <span class="nav-text">POC VIDEO</span></a></li>
			  <li class="nav-item nav-level-3">
			  <a class="nav-link" href="#CWE4344">
			  <span class="nav-number">2.4.</span>
			  <span class="nav-text">Updating Reported</span></a></li>
			  <li class="nav-item nav-level-3">
			  <a class="nav-link" href="#CWE4345">
			  <span class="nav-number">2.5.</span> 				  
			  <span class="nav-text">Concluding</span></a></ol></li>	          
	  
			  <li class="nav-item nav-level-2">
			  <a class="nav-link" href="#DISCLAIMER">
			  <span class="nav-number"></span> 
			  <span class="nav-text">DISCLAIMER</span></a></li>


</div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
<div class="copyright">&copy; <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Donnazmi</span>

  

  
</div>




  <div class="powered-by">Ungku Nazmi</div>



  <span class="post-meta-divider">|</span>



  



<div class="powered-by">
<i class="fa fa-user-md"></i><span id="busuanzi_container_site_uv">
  Number Of Visitor:<span id="busuanzi_value_site_uv"></span>
</span>
</div>
        








        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>


























  
  
    <script type="text/javascript" src="../../../../lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="../../../../lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="../../../../lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  


  


  <script type="text/javascript" src="../../../../js/src/utils.js?v=6.0.6"></script>

  <script type="text/javascript" src="../../../../js/src/motion.js?v=6.0.6"></script>



  
  

  
  <script type="text/javascript" src="../../../../js/src/scrollspy.js?v=6.0.6"></script>
<script type="text/javascript" src="../../../../js/src/post-details.js?v=6.0.6"></script>



  


  <script type="text/javascript" src="../../../../js/src/bootstrap.js?v=6.0.6"></script>



  

  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url);
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  

  
  <script src="https://cdn1.lncld.net/static/js/av-core-mini-0.6.4.js"></script>
  <script>AV.initialize("E375xCJTHPvBWQQsLQwVquyQ-gzGzoHsz", "wMz9L7akGsy7ATec1hzsFkUu");</script>
  <script>
    function showTime(Counter) {
      var query = new AV.Query(Counter);
      var entries = [];
      var $visitors = $(".leancloud_visitors");

      $visitors.each(function () {
        entries.push( $(this).attr("id").trim() );
      });

      query.containedIn('url', entries);
      query.find()
        .done(function (results) {
          var COUNT_CONTAINER_REF = '.leancloud-visitors-count';

          if (results.length === 0) {
            $visitors.find(COUNT_CONTAINER_REF).text(0);
            return;
          }

          for (var i = 0; i < results.length; i++) {
            var item = results[i];
            var url = item.get('url');
            var time = item.get('time');
            var element = document.getElementById(url);

            $(element).find(COUNT_CONTAINER_REF).text(time);
          }
          for(var i = 0; i < entries.length; i++) {
            var url = entries[i];
            var element = document.getElementById(url);
            var countSpan = $(element).find(COUNT_CONTAINER_REF);
            if( countSpan.text() == '') {
              countSpan.text(0);
            }
          }
        })
        .fail(function (object, error) {
          console.log("Error: " + error.code + " " + error.message);
        });
    }

    function addCount(Counter) {
      var $visitors = $(".leancloud_visitors");
      var url = $visitors.attr('id').trim();
      var title = $visitors.attr('data-flag-title').trim();
      var query = new AV.Query(Counter);

      query.equalTo("url", url);
      query.find({
        success: function(results) {
          if (results.length > 0) {
            var counter = results[0];
            counter.fetchWhenSave(true);
            counter.increment("time");
            
            counter.save(null, {
              success: function(counter) {
                
                  var $element = $(document.getElementById(url));
                  $element.find('.leancloud-visitors-count').text(counter.get('time'));
                
              },
              error: function(counter, error) {
                console.log('Failed to save Visitor num, with error message: ' + error.message);
              }
            });
          } else {
            
              var newcounter = new Counter();
              /* Set ACL */
              var acl = new AV.ACL();
              acl.setPublicReadAccess(true);
              acl.setPublicWriteAccess(true);
              newcounter.setACL(acl);
              /* End Set ACL */
              newcounter.set("title", title);
              newcounter.set("url", url);
              newcounter.set("time", 1);
              newcounter.save(null, {
                success: function(newcounter) {
                  var $element = $(document.getElementById(url));
                  $element.find('.leancloud-visitors-count').text(newcounter.get('time'));
                },
                error: function(newcounter, error) {
                  console.log('Failed to create');
                }
              });
            
          }
        },
        error: function(error) {
          console.log('Error:' + error.code + " " + error.message);
        }
      });
    }

    $(function() {
      var Counter = AV.Object.extend("Counter");
      if ($('.leancloud_visitors').length == 1) {
        addCount(Counter);
      } else if ($('.post-title-link').length > 1) {
        showTime(Counter);
      }
    });
  </script>



  

  

  

  
  

  

  

  

  

</body>
</html>
